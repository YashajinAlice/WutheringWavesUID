# 鳴潮卡片分析後儲存格式說明

## 儲存位置
- **文件路徑**: `PLAYER_PATH / {uid} / rawData.json`
- **格式**: JSON 數組，包含所有角色的數據

## 數據結構

### 根結構
```json
[
  {
    "chainList": [...],
    "level": 90,
    "phantomData": {...},
    "role": {...},
    "skillList": [...],
    "weaponData": {...}
  },
  ...
]
```

---

## 1. chainList (共鳴鏈列表)

```json
"chainList": [
  {
    "name": "共鳴鏈名稱",
    "order": 1,
    "description": "描述",
    "iconUrl": "圖標URL",
    "unlocked": true
  },
  ...
]
```

**字段說明**:
- `name`: 共鳴鏈名稱
- `order`: 順序（1-6）
- `description`: 描述文字
- `iconUrl`: 圖標URL
- `unlocked`: 是否解鎖（布林值）

---

## 2. level (角色等級)

```json
"level": 90
```

**類型**: 整數（1-90）

---

## 3. phantomData (聲骸數據)

```json
"phantomData": {
  "cost": 12,
  "equipPhantomList": [
    {
      "cost": 4,
      "level": 25,
      "quality": 5,
      "fetterDetail": {
        "firstDescription": "2件套效果描述",
        "groupId": 0,
        "iconUrl": "",
        "name": "合鳴效果名稱",
        "num": 5,
        "secondDescription": "5件套效果描述",
        "tripleDescription": "3件套效果描述"
      },
      "phantomProp": {
        "cost": 4,
        "iconUrl": "",
        "name": "聲骸名稱",
        "phantomId": 391070105,
        "phantomPropId": 0,
        "quality": 5,
        "skillDescription": "技能描述"
      },
      "mainProps": [
        {
          "attributeName": "攻擊",
          "attributeValue": "30%",
          "iconUrl": ""
        },
        {
          "attributeName": "生命",
          "attributeValue": "22.8%",
          "iconUrl": ""
        }
      ],
      "subProps": [
        {
          "attributeName": "暴擊",
          "attributeValue": "5.2%"
        },
        {
          "attributeName": "暴擊傷害",
          "attributeValue": "10.4%"
        },
        ...
      ]
    },
    ...
  ]
}
```

**字段說明**:
- `cost`: 總cost值（整數）
- `equipPhantomList`: 裝備的聲骸列表（最多5個）

**聲骸對象字段**:
- `cost`: 該聲骸的cost值（1/3/4）
- `level`: 聲骸等級（通常為25）
- `quality`: 品質（通常為5）
- `fetterDetail`: 合鳴效果詳情
  - `name`: 合鳴效果名稱
  - `num`: 套裝數量
  - `firstDescription`: 2件套效果
  - `tripleDescription`: 3件套效果
  - `secondDescription`: 5件套效果
- `phantomProp`: 聲骸屬性
  - `phantomId`: 聲骸ID
  - `name`: 聲骸名稱
  - `cost`: cost值
  - `quality`: 品質
- `mainProps`: 主詞條列表（2個）
  - `attributeName`: 屬性名稱（如"攻擊"、"生命"、"防禦"等）
  - `attributeValue`: 屬性數值（如"30%"、"22.8%"等）
  - `iconUrl`: 圖標URL
- `subProps`: 副詞條列表（最多6個）
  - `attributeName`: 屬性名稱
  - `attributeValue`: 屬性數值

---

## 4. role (角色信息)

```json
"role": {
  "acronym": "角色縮寫",
  "attributeId": "屬性ID",
  "attributeName": "屬性名稱",
  "breach": 6,
  "chainUnlockNum": 6,
  "isMainRole": false,
  "level": 90,
  "roleIconUrl": "角色圖標URL",
  "roleId": "1506",
  "roleName": "角色名稱",
  "rolePicUrl": "角色圖片URL",
  "starLevel": 5,
  "weaponTypeId": "武器類型ID",
  "weaponTypeName": "武器類型名稱"
}
```

**字段說明**:
- `roleId`: 角色ID（字符串）
- `roleName`: 角色名稱
- `level`: 角色等級（1-90）
- `breach`: 突破等級（0-6，根據等級計算）
- `chainUnlockNum`: 解鎖的共鳴鏈數量（1-6）
- `starLevel`: 星級（通常為5）
- `attributeName`: 屬性名稱（如"衍射"、"熱熔"等）
- `weaponTypeName`: 武器類型名稱

---

## 5. skillList (技能列表)

```json
"skillList": [
  {
    "level": 10,
    "skill": {
      "description": "技能描述",
      "iconUrl": "圖標URL",
      "id": "技能ID",
      "name": "技能名稱",
      "type": "技能類型"
    }
  },
  ...
]
```

**字段說明**:
- `level`: 技能等級（1-10）
- `skill`: 技能詳情
  - `id`: 技能ID
  - `name`: 技能名稱
  - `type`: 技能類型（如"普攻"、"共鳴技能"等）
  - `description`: 技能描述
  - `iconUrl`: 圖標URL

**技能順序**:
1. 普攻
2. 共鳴技能
3. 共鳴解放
4. 變奏技能
5. 共鳴回路

---

## 6. weaponData (武器數據)

```json
"weaponData": {
  "breach": 6,
  "level": 90,
  "resonLevel": 5,
  "weapon": {
    "weaponEffectName": "武器效果名稱",
    "weaponIcon": "武器圖標URL",
    "weaponId": 10001,
    "weaponName": "武器名稱",
    "weaponStarLevel": 5,
    "weaponType": "武器類型"
  }
}
```

**字段說明**:
- `level`: 武器等級（1-90）
- `breach`: 突破等級（0-6，根據等級計算）
- `resonLevel`: 精煉等級（1-5）
- `weapon`: 武器詳情
  - `weaponId`: 武器ID（整數）
  - `weaponName`: 武器名稱
  - `weaponStarLevel`: 武器星級（1-5）
  - `weaponType`: 武器類型
  - `weaponEffectName`: 武器效果名稱
  - `weaponIcon`: 武器圖標URL

---

## 完整範例

```json
[
  {
    "chainList": [
      {
        "name": "共鳴鏈1",
        "order": 1,
        "description": "描述1",
        "iconUrl": "url1",
        "unlocked": true
      },
      {
        "name": "共鳴鏈2",
        "order": 2,
        "description": "描述2",
        "iconUrl": "url2",
        "unlocked": true
      }
    ],
    "level": 90,
    "phantomData": {
      "cost": 12,
      "equipPhantomList": [
        {
          "cost": 4,
          "level": 25,
          "quality": 5,
          "fetterDetail": {
            "firstDescription": "2件套效果",
            "groupId": 0,
            "iconUrl": "",
            "name": "合鳴一",
            "num": 5,
            "secondDescription": "5件套效果",
            "tripleDescription": "3件套效果"
          },
          "phantomProp": {
            "cost": 4,
            "iconUrl": "",
            "name": "聲骸名稱",
            "phantomId": 391070105,
            "phantomPropId": 0,
            "quality": 5,
            "skillDescription": "技能描述"
          },
          "mainProps": [
            {
              "attributeName": "攻擊",
              "attributeValue": "30%",
              "iconUrl": ""
            }
          ],
          "subProps": [
            {
              "attributeName": "暴擊",
              "attributeValue": "5.2%"
            }
          ]
        }
      ]
    },
    "role": {
      "acronym": "縮寫",
      "attributeId": "attr_id",
      "attributeName": "衍射",
      "breach": 6,
      "chainUnlockNum": 6,
      "isMainRole": false,
      "level": 90,
      "roleIconUrl": "icon_url",
      "roleId": "1506",
      "roleName": "角色名",
      "rolePicUrl": "pic_url",
      "starLevel": 5,
      "weaponTypeId": "type_id",
      "weaponTypeName": "長刃"
    },
    "skillList": [
      {
        "level": 10,
        "skill": {
          "description": "技能描述",
          "iconUrl": "icon_url",
          "id": "skill_id",
          "name": "普攻",
          "type": "普攻"
        }
      }
    ],
    "weaponData": {
      "breach": 6,
      "level": 90,
      "resonLevel": 5,
      "weapon": {
        "weaponEffectName": "效果名稱",
        "weaponIcon": "icon_url",
        "weaponId": 10001,
        "weaponName": "武器名稱",
        "weaponStarLevel": 5,
        "weaponType": "長刃"
      }
    }
  }
]
```

---

## 備註

1. **儲存方式**: 數據以 JSON 格式儲存，使用 `ensure_ascii=False` 確保中文正確顯示
2. **更新邏輯**: 如果已存在相同 `roleId` 的數據，會進行合併更新
3. **數據驗證**: 儲存前會進行聲骸數據驗證，檢查重複詞條等異常情況
4. **等級保護**: 如果新識別的等級低於已儲存的等級，會保留較高的等級

